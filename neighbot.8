.Dd February 23, 2026
.Dt NEIGHBOT 8
.Os
.Sh NAME
.Nm neighbot
.Nd network neighbor monitoring daemon
.Sh SYNOPSIS
.Nm
.Op Fl d
.Op Fl f Ar dbfile
.Op Fl m Ar mailto
.Op Fl q
.Op Fl u Ar user
.Sh DESCRIPTION
.Nm
passively monitors ARP (IPv4) and NDP (IPv6) traffic on all Ethernet
interfaces.
It maintains a database of IP-to-MAC address mappings and sends email
alerts when new stations appear or existing mappings change.
Notifications include reverse DNS hostname, hardware vendor
(from the OUI database, if available), and timestamps.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl d
Daemonize.
Detach from the terminal and log to syslog instead of stderr.
.It Fl f Ar dbfile
Path to the database file.
Default:
.Pa /var/neighbot/neighbot.csv .
.It Fl m Ar mailto
Email recipient for notifications.
Default:
.Ql root .
.It Fl q
Quiet mode.
Suppress email notifications.
Events are still logged.
.It Fl u Ar user
Drop privileges to
.Ar user
after opening packet capture handles.
The database directory and file are chowned to this user before
dropping.
Default:
.Ql nobody .
.El
.Sh DATABASE FORMAT
The database is a CSV file with the following fields:
.Pp
.D1 ip,mac,interface,first_seen,last_seen
.Pp
Timestamps are in ISO 8601 format (local time).
The database is saved atomically via a temporary file and rename.
.Pp
The maximum number of entries is limited to 100000 to prevent
memory exhaustion from spoofed traffic.
.Sh SIGNALS
.Bl -tag -width SIGTERM
.It Dv SIGHUP
Save the database to disk.
.It Dv SIGTERM , Dv SIGINT
Save the database and exit.
.It Dv SIGPIPE
Ignored.
.El
.Sh FILES
.Bl -tag -width "/usr/local/share/neighbot/oui.txt"
.It Pa /var/neighbot/neighbot.csv
Default database file.
.It Pa /usr/local/share/neighbot/oui.txt
OUI vendor database (optional).
If present, email notifications include the hardware vendor name
resolved from the MAC address prefix.
Generate with
.Sq make oui-update
and install with
.Sq make install-oui .
.It Pa /etc/systemd/system/neighbot.service
Systemd unit file (Linux).
.It Pa /etc/rc.d/neighbot
rc.d script (OpenBSD).
.El
.Sh SECURITY
.Nm
drops to an unprivileged user
.Pq default: nobody
after opening packet capture handles.
All supplementary groups are dropped.
.Pp
On
.Ox ,
.Nm
additionally uses
.Xr pledge 2
and
.Xr unveil 2
to restrict its privileges after initialization.
.Pp
In quiet mode
.Pq Fl q ,
.Nm
pledges
.Cm stdio rpath wpath cpath
and unveils only the database directory.
.Pp
When email notifications are enabled,
.Nm
pledges
.Cm stdio rpath wpath cpath proc exec dns
and does not use
.Xr unveil 2
so that
.Xr sendmail 8
can access its configuration files.
.Sh EXIT STATUS
.Nm
exits 0 on clean shutdown, or 1 if no usable interfaces were found.
.Sh SEE ALSO
.Xr pledge 2 ,
.Xr unveil 2 ,
.Xr arpwatch 8 ,
.Xr tcpdump 8
.Sh AUTHORS
.An neighbot contributors
